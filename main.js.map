{"version":3,"file":"main.js","mappings":"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","sources":["webpack://squarefall/./src/constants.js","webpack://squarefall/./src/grid/grid.js","webpack://squarefall/./src/score/score.js","webpack://squarefall/./src/game/game.js","webpack://squarefall/./src/point/point.js","webpack://squarefall/./src/square/square.js","webpack://squarefall/./src/shape/shape.js","webpack://squarefall/./src/bootstrap.js","webpack://squarefall/./src/speed/speed.js","webpack://squarefall/./src/shape-generator/shape-generator.js","webpack://squarefall/./src/leaderboard/leaderboard.service.js","webpack://squarefall/./src/leaderboard/leaderboard.js"],"sourcesContent":["export const SQUARE_SIDE_LENGTH = 50\n","import {\n  SQUARE_SIDE_LENGTH\n} from '../constants.js'\n\nexport const emptySquareCharacter = '\\u2b1c'\nexport const fullSquareCharacter = '\\u2b1b'\n\nexport default class Grid {\n  constructor (canvas, context, speed) {\n    this.canvas = canvas\n    this.context = context\n    this.speed = speed\n    this.shapes = []\n    this.movingShape = undefined\n  }\n\n  moveShapeDown () {\n    if (this.thereIsRoomToMoveDown()) {\n      this.movingShape.moveDown()\n    }\n  }\n\n  moveShapeLeft () {\n    if (this.thereIsRoomToMoveLeft()) {\n      this.movingShape.moveLeft()\n    }\n  }\n\n  moveShapeRight () {\n    if (this.thereIsRoomToMoveRight()) {\n      this.movingShape.moveRight()\n    }\n  }\n\n  moveShapeToBottom () {\n    while (this.thereIsRoomToMoveDown()) {\n      this.moveShapeDown()\n    }\n  }\n\n  noOtherShapeIsInTheWayDown () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint => {\n              const diff = Math.round(otherPoint.y - (point.y + SQUARE_SIDE_LENGTH))\n              const diffSmallEnough = Math.abs(diff) <= this.speed.calculatedValue\n              const meets = otherPoint.x === point.x && diffSmallEnough && diff >= 0\n              return meets\n            })\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  noOtherShapeIsInTheWayLeft () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x + SQUARE_SIDE_LENGTH === point.x &&\n              Math.abs(point.y - otherPoint.y) < SQUARE_SIDE_LENGTH)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  noOtherShapeIsInTheWayRight () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x === point.x + SQUARE_SIDE_LENGTH &&\n              Math.abs(point.y - otherPoint.y) < SQUARE_SIDE_LENGTH)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  rotateShape () {\n    const originalCoordinates = this.movingShape.getCoordinatesOfSquares()\n\n    this.movingShape.rotateClockwise()\n\n    if (!(this.allPointsFitInsideGrid() && this.noOtherShapeIsInTheWay(this.movingShape))) {\n      this.movingShape.restoreCoordinatesOfSquares(originalCoordinates)\n    }\n  }\n\n  allPointsFitInsideGrid () {\n    return this.movingShape.squares.map(square => square.point.x)\n      .every(x => x >= 0 && x <= this.canvas.width - SQUARE_SIDE_LENGTH) &&\n      this.movingShape.squares.map(square => square.point.y)\n        .every(y => y >= 0 && y <= this.canvas.height - SQUARE_SIDE_LENGTH)\n  }\n\n  thereIsRoomToMoveDown () {\n    const largestY = this.movingShape.getLargestY()\n    return (largestY + SQUARE_SIDE_LENGTH < this.canvas.height) && this.noOtherShapeIsInTheWayDown()\n  }\n\n  thereIsRoomToMoveLeft () {\n    return this.movingShape.getSmallestX() - SQUARE_SIDE_LENGTH >= 0 && this.noOtherShapeIsInTheWayLeft()\n  }\n\n  thereIsRoomToMoveRight () {\n    return this.movingShape.getLargestX() + SQUARE_SIDE_LENGTH < this.canvas.width && this.noOtherShapeIsInTheWayRight()\n  }\n\n  removeFullRows () {\n    const amountOfPointsInRow = this.canvas.width / SQUARE_SIDE_LENGTH\n    const rowCount = this.canvas.height / SQUARE_SIDE_LENGTH\n    let fullRowCount = 0\n\n    for (let i = 0; i < rowCount; i += 1) {\n      const occupiedSquaresAndShapes = new Map()\n      for (const shape of this.shapes) {\n        for (const square of shape.squares) {\n          if (square.point.y === i * SQUARE_SIDE_LENGTH) {\n            occupiedSquaresAndShapes.set(square, shape)\n          }\n        }\n      }\n\n      if (occupiedSquaresAndShapes.size === amountOfPointsInRow) {\n        fullRowCount += 1\n        for (const [square, shape] of occupiedSquaresAndShapes) {\n          shape.remove(square)\n        }\n        this.shiftDownward(i)\n      }\n    }\n    this.shapes = this.shapes.filter(shape => shape.squares.length > 0)\n    return fullRowCount\n  }\n\n  shiftDownward (rowIndex) {\n    //  Everything that is above this rowIndex must shift down by SIDE_LENGTH.\n    const yLimit = rowIndex * SQUARE_SIDE_LENGTH\n    for (const shape of this.shapes) {\n      shape.moveSquaresBelowYLimit(yLimit)\n    }\n  }\n\n  noOtherShapeIsInTheWay (shape) {\n    for (const otherShape of this.shapes) {\n      if (otherShape !== shape) {\n        if (otherShape.hasCommonPointWith(shape)) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  hasOccupiedPoint (x, y) {\n    const hasOccupiedPointPerShape = this.shapes.map(shape => shape.hasOccupiedPoint(x, y))\n    return hasOccupiedPointPerShape.includes(true)\n  }\n\n  print () {\n    let allRows = ''\n    for (let y = 0; y < this.canvas.height; y += SQUARE_SIDE_LENGTH) {\n      let row = ''\n      for (let x = 0; x < this.canvas.width; x += SQUARE_SIDE_LENGTH) {\n        if (this.hasOccupiedPoint(x, y)) {\n          row += fullSquareCharacter\n        } else {\n          row += emptySquareCharacter\n        }\n      }\n      if (y !== this.canvas.height - SQUARE_SIDE_LENGTH) {\n        row += '\\n'\n      }\n      allRows += row\n    }\n    return allRows\n  }\n}\n","export default class Score {\n  constructor () {\n    this.high = Score.getHighScore()\n    document.getElementById('high-score').innerText = this.high\n    this.current = 0\n  }\n\n  static getHighScore () {\n    let highScore = localStorage.getItem('tetris-high')\n    if (highScore === undefined) {\n      highScore = 0\n    }\n    return highScore\n  }\n\n  static calculateIncrease (rowsCleared) {\n    const score = (2 ** rowsCleared) + 2\n    return score\n  }\n\n  increment (value) {\n    this.current += value\n    document.getElementById('current-score').innerText = this.current\n  }\n\n  get () {\n    return this.current\n  }\n\n  set (newValue) {\n    this.current = newValue\n  }\n\n  submit () {\n    if (this.current > this.high) {\n      localStorage.setItem('tetris-high', this.current)\n      document.getElementById('high-score').innerText = this.current\n      document.getElementById('scoreContainer').classList.add('shaken')\n      setTimeout(\n        () => document.getElementById('scoreContainer').classList.remove('shaken'),\n        1000\n      )\n    }\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nimport Grid from '../grid/grid.js'\nimport Score from '../score/score.js'\n\nexport class Game {\n  constructor (canvas, context, shapeGenerator, speed, leaderboard) {\n    this.canvas = canvas\n    this.context = context\n    this.shapeGenerator = shapeGenerator\n    this.speed = speed\n    this.leaderboard = leaderboard\n  }\n\n  update () {\n    if (this.grid.movingShape) {\n      if (this.grid.thereIsRoomToMoveDown()) {\n        this.grid.moveShapeDown()\n      } else {\n        this.grid.movingShape.roundYCoordinatesToNearestTen()\n        this.grid.movingShape = undefined\n        const fullRowCount = this.grid.removeFullRows()\n        if (fullRowCount > 0) {\n          this.requestScoreIncrease(fullRowCount)\n          this.requestSpeedIncrease()\n        }\n      }\n    } else {\n      const generatedShape = this.shapeGenerator.generateShape()\n      if (this.grid.noOtherShapeIsInTheWay(generatedShape)) {\n        this.grid.shapes.push(generatedShape)\n        this.grid.movingShape = generatedShape\n      } else {\n        this.end()\n      }\n    }\n  }\n\n  draw () {\n    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\n    this.grid.shapes.forEach(shape => {\n      if (shape === this.grid.movingShape) {\n        shape.drawAsRectangles()\n      } else {\n        shape.drawAsSquares()\n      }\n    })\n  }\n\n  gameLoop () {\n    if (!this.isPaused && !this.isOver) {\n      this.update()\n      this.draw()\n      this.currentAnimationFrameRequestId = window.requestAnimationFrame(() => this.gameLoop())\n    }\n  }\n\n  init () {\n    this.setCanvasWidth()\n    this.setCanvasHeight()\n\n    window.setTimeout(() => {\n      document.getElementById('loading').hidden = true\n      document.getElementById('container').style.display = 'grid'\n    }, 200) // to allow the user some time to spot the loading text\n\n    this.grid = new Grid(this.canvas, this.context, this.speed)\n    this.score = new Score()\n    document.getElementById('current-speed').innerText = this.speed.shownValue\n    this.SCORE_PER_SPEED_INCREASE = 50\n    this.MAX_SPEED = 9\n    this.paused = (event) => {\n      if (this.grid.movingShape && event.key === 'p') {\n        this.pause()\n      }\n    }\n    this.keyPressed = (event) => {\n      if (this.grid.movingShape) {\n        switch (event.key) {\n          case 'j':\n            this.grid.moveShapeLeft()\n            break\n          case 'k':\n            this.grid.rotateShape()\n            break\n          case 'l':\n            this.grid.moveShapeRight()\n            break\n          case ' ':\n            this.grid.moveShapeToBottom()\n            break\n          default: break\n        }\n      }\n    }\n    this.keyHandler = this.keyPressed.bind(this)\n    window.addEventListener('keypress', this.keyHandler)\n    this.pauseKeyHandler = this.paused.bind(this)\n    window.addEventListener('keypress', this.pauseKeyHandler)\n\n    this.leaderboard.reset()\n\n    this.isPaused = false\n\n    this.currentAnimationFrameRequestId = window.requestAnimationFrame(() => this.gameLoop())\n  }\n\n  setCanvasWidth () {\n    const desiredWidth = 10 * SQUARE_SIDE_LENGTH\n\n    if (desiredWidth < window.screen.availWidth) {\n      this.canvas.width = desiredWidth\n    }\n  }\n\n  setCanvasHeight () {\n    let desiredHeight = window.screen.availHeight\n\n    if (desiredHeight > 20 * SQUARE_SIDE_LENGTH) {\n      desiredHeight = 20 * SQUARE_SIDE_LENGTH\n    }\n\n    /* This is an estimation, and may be inaccurate, depending on whether\n    the browser has its bookmarks toolbar set to show, etc. */\n    const assumedToolbarsHeight = 100\n\n    desiredHeight -= assumedToolbarsHeight\n\n    desiredHeight -= (desiredHeight % SQUARE_SIDE_LENGTH) || SQUARE_SIDE_LENGTH\n\n    this.canvas.height = desiredHeight\n  }\n\n  end () {\n    this.score.submit()\n    Game.showGameOverText()\n    window.clearInterval(this.heartbeatInterval)\n    window.removeEventListener('keypress', this.keyHandler)\n    window.removeEventListener('keypress', this.pauseKeyHandler)\n    this.isOver = true\n\n    this.leaderboard.showScoreSubmissionModalIfEligible(this.score.get())\n  }\n\n  requestSpeedIncrease () {\n    if (this.speed.shownValue < this.MAX_SPEED) {\n      const desiredShownValue = Math.trunc(this.score.get() / this.SCORE_PER_SPEED_INCREASE) + 1\n      this.speed.increaseIfNecessary(desiredShownValue)\n    }\n  }\n\n  requestScoreIncrease (rowsCleared) {\n    this.score.increment(rowsCleared)\n  }\n\n  pause () {\n    if (this.isPaused) {\n      this.isPaused = false\n      window.addEventListener('keypress', this.keyHandler)\n      this.gameLoop()\n    } else {\n      this.isPaused = true\n      window.cancelAnimationFrame(this.currentAnimationFrameRequestId)\n      window.removeEventListener('keypress', this.keyHandler)\n    }\n  }\n\n  static showGameOverText () {\n    document.getElementById('gameOverContainer').hidden = false\n  }\n}\n","import {\n  SQUARE_SIDE_LENGTH\n} from '../constants.js'\n\nexport default class Point {\n  constructor (x, y) {\n    this.x = x\n    this.y = y\n  }\n\n  moveDownBy (distance) {\n    this.y += distance\n  }\n\n  moveLeft () {\n    this.x += -SQUARE_SIDE_LENGTH\n  }\n\n  moveRight () {\n    this.x += SQUARE_SIDE_LENGTH\n  }\n\n  transformClockwise (oldX, oldY) {\n    this.translate(-oldX, -oldY)\n    this.rotateClockwise()\n    this.translate(oldX, oldY)\n  }\n\n  translate (offsetX, offsetY) {\n    this.x = this.x + offsetX\n    this.y = this.y + offsetY\n  }\n\n  rotateClockwise () {\n    const oldX = this.x\n    const oldY = this.y\n\n    /*\n    We are performing a clockwise 90 degree rotation in a 2D coordinate system.\n    https://en.wikipedia.org/wiki/Rotation_matrix\n\n    90 degrees = Math.PI / 2 radians\n    Math.sin(Math.PI / 2) = 1\n    Math.cos(Math.PI / 2) = 0\n\n    newX = oldX * 0 - oldY * 1 = -oldY\n    newY = oldX * 1 + oldY * 0 = oldX\n    */\n\n    this.x = -oldY\n    this.y = oldX\n\n    this.roundXCoordinateToNearestTen()\n    this.roundYCoordinateToNearestTen()\n  }\n\n  equals (otherPoint) {\n    return otherPoint instanceof Point &&\n      typeof otherPoint.x === 'number' &&\n      typeof otherPoint.y === 'number' &&\n      this.x === otherPoint.x &&\n      this.y === otherPoint.y\n  }\n\n  occupiesCoordinates (x, y) {\n    return this.x === x && this.y === y\n  }\n\n  roundYCoordinateToNearestTen () {\n    this.y = this.roundToNearestTen(this.y)\n  }\n\n  roundXCoordinateToNearestTen () {\n    this.x = this.roundToNearestTen(this.x)\n  }\n\n  roundToNearestTen (number) {\n    const numberDividedByTen = number / 10 // e.g. 85.1\n    const numberWhole = numberDividedByTen.toFixed() // e.g. 85\n    const numberWholeTimesTen = numberWhole * 10 // e.g. 850\n    return numberWholeTimesTen\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nexport default class Square {\n  constructor (point, fillStyle, context, speed) {\n    // The point of a Square always refers to its top left point\n    this.point = point\n    this.fillStyle = fillStyle\n    this.context = context\n    this.sideLength = SQUARE_SIDE_LENGTH\n    this.speed = speed\n  }\n\n  draw () {\n    this.context.beginPath()\n    this.context.fillStyle = this.fillStyle\n    this.context.fillRect(this.point.x, this.point.y, this.sideLength, this.sideLength)\n  }\n\n  clear () {\n    this.context.clearRect(this.point.x, this.point.y, this.sideLength, this.sideLength)\n  }\n\n  equals (otherSquare) {\n    return otherSquare !== undefined &&\n      otherSquare instanceof Square &&\n      this.sideLength === otherSquare.sideLength &&\n      this.point.equals(otherSquare.point)\n  }\n\n  overlaps (otherSquare) {\n    return otherSquare !== undefined &&\n      otherSquare instanceof Square &&\n      this.sideLength === otherSquare.sideLength &&\n      Math.abs(this.point.x - otherSquare.point.x) < SQUARE_SIDE_LENGTH &&\n      Math.abs(this.point.y - otherSquare.point.y) < SQUARE_SIDE_LENGTH\n  }\n\n  moveDownBy (distance) {\n    this.point.moveDownBy(distance)\n  }\n\n  moveLeft () {\n    this.point.moveLeft()\n  }\n\n  moveRight () {\n    this.point.moveRight()\n  }\n\n  transformClockwise (x, y) {\n    this.point.transformClockwise(x, y)\n  }\n\n  isBelowLimit (yLimit) {\n    return this.point.y < yLimit\n  }\n\n  hasOccupiedPoint (x, y) {\n    return this.point.occupiesCoordinates(x, y)\n  }\n\n  roundYCoordinateToNearestTen () {\n    this.point.roundYCoordinateToNearestTen()\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nimport Point from '../point/point.js'\nimport Square from '../square/square.js'\n\nexport class Shape {\n  init (fillStyle, pointOfTranslation, points, context, speed) {\n    this.pointOfTranslation = pointOfTranslation\n\n    const pointOfTranslationSquare = new Square(pointOfTranslation, fillStyle, context, speed)\n    const otherSquares = points.map(point => new Square(point, fillStyle, context, speed))\n\n    this.squares = [pointOfTranslationSquare, ...otherSquares]\n\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n\n    this.context = context\n    this.speed = speed\n  }\n\n  getPointOfTranslationX () {\n    return this.getPointOfTranslationX\n  }\n\n  remove (squareToRemove) {\n    if (Object.prototype.hasOwnProperty.call(squareToRemove, 'point') &&\n      Object.prototype.hasOwnProperty.call(squareToRemove.point, 'x') &&\n      Object.prototype.hasOwnProperty.call(squareToRemove.point, 'y')) {\n      this.squares = this.squares.filter(square => !(square.equals(squareToRemove)))\n      this.largestY = this.calculateLargestY()\n      this.smallestX = this.calculateSmallestX()\n      this.largestX = this.calculateLargestX()\n    }\n  }\n\n  drawAsSquares () {\n    this.squares.forEach(square => square.draw())\n  }\n\n  drawPoints () {\n    this.squares.forEach(square => square.drawPoint())\n  }\n\n  clear () {\n    this.squares.forEach(square => square.clear())\n  }\n\n  rotateClockwise () {\n    this.squares.forEach(square => {\n      square.transformClockwise(this.pointOfTranslation.x, this.pointOfTranslation.y)\n    })\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  hasPoint (otherPoint) {\n    const points = this.squares.map(square => new Point(square.point.x, square.point.y))\n    const thisPoint = points.filter(point => point.equals(otherPoint))\n    return thisPoint !== undefined && thisPoint.length && thisPoint.length !== 0 && thisPoint.equals(otherPoint)\n  }\n\n  hasCommonPointWith (otherShape) {\n    for (const square of this.squares) {\n      for (const otherSquare of otherShape.squares) {\n        if (square.overlaps(otherSquare)) {\n          return true\n        }\n      }\n    }\n\n    return false\n  }\n\n  moveDown () {\n    this.squares.forEach(square => square.moveDownBy(this.speed.calculatedValue))\n    this.largestY = this.calculateLargestY()\n  }\n\n  moveLeft () {\n    this.squares.forEach(square => square.moveLeft())\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  moveRight () {\n    this.squares.forEach(square => square.moveRight())\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  calculateLargestY () {\n    return this.squares\n      .map(square => square.point.y)\n      .sort((a, b) => b - a)[0]\n  }\n\n  calculateSmallestX () {\n    return this.squares\n      .map(square => square.point.x)\n      .sort()\n      .shift()\n  }\n\n  calculateLargestX () {\n    return this.squares\n      .map(square => square.point.x)\n      .sort()\n      .pop()\n  }\n\n  getLargestY () {\n    return this.largestY\n  }\n\n  getSmallestX () {\n    return this.smallestX\n  }\n\n  getLargestX () {\n    return this.largestX\n  }\n\n  moveSquaresBelowYLimit (yLimit) {\n    this.squares.forEach(square => {\n      if (square.isBelowLimit(yLimit)) {\n        square.moveDownBy(SQUARE_SIDE_LENGTH)\n      }\n    })\n  }\n\n  hasOccupiedPoint (x, y) {\n    const hasOccupiedPointPerSquare = this.squares.map(square => square.hasOccupiedPoint(x, y))\n    return hasOccupiedPointPerSquare.includes(true)\n  }\n\n  roundYCoordinatesToNearestTen () {\n    this.squares.forEach(square => {\n      square.roundYCoordinateToNearestTen()\n    })\n  }\n\n  getCoordinatesOfSquares () {\n    return this.squares.map(square => ({\n      x: square.point.x,\n      y: square.point.y\n    }))\n  }\n\n  restoreCoordinatesOfSquares (originalCoordinates) {\n    for (let i = 0; i < originalCoordinates.length; i++) {\n      this.squares[i].point.x = originalCoordinates[i].x\n      this.squares[i].point.y = originalCoordinates[i].y\n    }\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  /**\n   * Subpixel antialiasing is always enabled when using canvas and I am using potential floating point numbers\n   * as y-coordinates of top left points of squares for drawing. This resulted in visible vertical tearing between\n   * the squares of the moving shape.\n   * This is a workaround.\n   * Contiguous vertical squares are 'stitched' together for the purpose of drawing only.\n   */\n  drawAsRectangles () {\n    const clonedSortedSquares = [...this.squares].sort((squareA, squareB) => squareA.point.y - squareB.point.y)\n    const verticalRectangles = clonedSortedSquares.reduce((acc, square) => {\n      const earlierContiguousSquare = acc.find(earlierSquare => {\n        const diff = Math.abs(earlierSquare.y + earlierSquare.drawingHeight - square.point.y)\n        return earlierSquare.x === square.point.x && diff < 1e-10\n      })\n      if (earlierContiguousSquare) {\n        earlierContiguousSquare.drawingHeight += square.sideLength\n      } else {\n        acc.push({\n          x: square.point.x,\n          y: square.point.y,\n          drawingWidth: square.sideLength,\n          drawingHeight: square.sideLength\n        })\n      }\n      return acc\n    }, [])\n    this.context.fillStyle = this.squares[0].fillStyle\n    verticalRectangles.forEach(rect => this.context.fillRect(rect.x, rect.y, rect.drawingWidth, rect.drawingHeight))\n  }\n}\n\nclass O extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const point3 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'thistle'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  rotateClockwise () { }\n}\n\nclass T extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH, speed)\n    const point2 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const point3 = new Point(xCoordOfAppearance, 0, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'lightgrey'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass I extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const pointOfTranslation = new Point(xCoordOfAppearance, 0, speed)\n    const point1 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, 0, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'yellowgreen'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass S extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const point3 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'khaki'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass Z extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH, speed)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'tan'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass L extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, 0, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const point3 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'lightblue'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass J extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, 0, speed)\n    const point2 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, 0, speed)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'darksalmon'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nconst shapeTypes = {\n  I,\n  O,\n  L,\n  J,\n  S,\n  Z,\n  T\n}\n\nexport default shapeTypes\n","import { SQUARE_SIDE_LENGTH } from './constants.js'\n\nimport { Game } from './game/game.js'\nimport { ShapeGenerator } from './shape-generator/shape-generator.js'\nimport Speed from './speed/speed.js'\nimport { LeaderboardService } from './leaderboard/leaderboard.service.js'\nimport { Leaderboard } from './leaderboard/leaderboard.js'\n\nconst canvas = document.createElement('canvas')\ncanvas.setAttribute('id', 'gameCanvas')\n\nconst gameContainer = document.getElementById('gameContainer')\ngameContainer.append(canvas)\n\nconst context = canvas.getContext('2d')\nconst speed = new Speed(parseFloat((SQUARE_SIDE_LENGTH / 32).toFixed(1)))\nconst shapeGenerator = new ShapeGenerator(canvas, context, speed)\nconst leaderboardService = new LeaderboardService()\nconst leaderboard = new Leaderboard(leaderboardService)\nconst game = new Game(canvas, context, shapeGenerator, speed, leaderboard)\n\ngame.init()\n","export default class Speed {\n  constructor (pixelsPerFrame) {\n    this.shownValue = 1\n    this.calculatedValue = pixelsPerFrame\n  }\n\n  increase () {\n    this.shownValue += 1\n    this.calculatedValue = parseFloat((this.calculatedValue + 0.1).toFixed(1))\n  }\n\n  increaseIfNecessary (desiredShownValue) {\n    if (desiredShownValue > this.shownValue) {\n      this.increase()\n      document.getElementById('speedContainer').classList.add('shaken')\n      setTimeout(\n        () => document.getElementById('speedContainer').classList.remove('shaken'),\n        1000\n      )\n      document.getElementById('current-speed').innerText = this.shownValue\n    }\n    return this.shownValue\n  }\n}\n","import shapeTypes from '../shape/shape.js'\n\nexport class ShapeGenerator {\n  constructor (canvas, context, speed) {\n    this.canvas = canvas\n    this.context = context\n    this.speed = speed\n  }\n\n  generateShape () {\n    const shapeTypesAsArray = Object.values(shapeTypes)\n    const chosenShapeIndex = Math.round(Math.random() * (shapeTypesAsArray.length - 1))\n    const ChosenShapeType = shapeTypesAsArray[chosenShapeIndex]\n    const xCoordinateOfAppearance = this.canvas.width / 2\n    const shape = new ChosenShapeType(xCoordinateOfAppearance, this.context, this.speed)\n    return shape\n  }\n}\n","export class LeaderboardService {\n  constructor () {\n    this.boardUrl = 'https://scorepion.herokuapp.com/boards/e855ad08-4dc0-4527-af49-47f06d7fcfe3'\n    this.scoresUrl = this.boardUrl + '/scores'\n    this.eligibilityUrl = this.boardUrl + '/eligibility'\n  }\n\n  submit (name, value) {\n    window.fetch(this.scoresUrl, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        name,\n        value\n      })\n    })\n  }\n\n  async fetch () {\n    try {\n      const response = await window.fetch(this.scoresUrl)\n      if (!response.ok) {\n        console.log(response)\n        const { status, statusText } = response\n        const errorMessage = `error: ${status}\\t${statusText}`\n        return { status: errorMessage }\n      }\n      const scores = await response.json()\n      return { scores }\n    } catch (error) {\n      console.log(error)\n      return { status: 'error: API not available' }\n    }\n  }\n\n  async isEligible (score) {\n    try {\n      const params = new URLSearchParams({\n        score\n      })\n      const response = await window.fetch(`${this.eligibilityUrl}?${params}`)\n      if (!response.ok) {\n        const { status, statusText } = response\n        const errorMessage = `error: ${status}\\t${statusText}`\n        console.log(errorMessage)\n        return false\n      }\n      const isEligible = await response.json()\n      return isEligible\n    } catch (error) {\n      console.log(error)\n      return false\n    }\n  }\n}\n","export class Leaderboard {\n  constructor (scoreService) {\n    this.scoreService = scoreService\n  }\n\n  async reset () {\n    document.getElementById('leaderboardEntries').replaceChildren()\n    document.getElementById('status').innerText = 'Loading...'\n    document.getElementById('status').classList.remove('closed')\n\n    const response = await this.scoreService.fetch()\n    const { status, scores } = response\n    if (status) {\n      document.getElementById('status').innerText = status\n      document.getElementById('leaderboardEntries').style.display = 'none'\n    } else if (scores) {\n      document.getElementById('status').classList.add('closed')\n      document.getElementById('leaderboardEntries').style.display = 'grid'\n      for (const score of scores) {\n        const { name, value } = score\n        const leftDiv = document.createElement('div')\n        const rightDiv = document.createElement('div')\n        leftDiv.innerText = name\n        rightDiv.innerText = value\n        leftDiv.classList.add('score-entry-left')\n        rightDiv.classList.add('score-entry-right')\n        document.getElementById('leaderboardEntries').append(leftDiv, rightDiv)\n      }\n    }\n  }\n\n  async fetch () {\n    return this.scoreService.fetch()\n  }\n\n  submit (name, value) {\n    this.scoreService.submit(name, value)\n  }\n\n  async showScoreSubmissionModalIfEligible (score) {\n    const isEligible = await this.scoreService.isEligible(score)\n\n    if (isEligible) {\n      if (document.getElementById('leaderboard-modal').classList.contains('closed')) {\n        document.getElementById('submitted-name').value = 'Ann Onymous'\n        document.getElementById('submitted-score').innerText = score\n        document.getElementById('submit-button').addEventListener('click', () => {\n          const name = document.getElementById('submitted-name').value\n          const value = score\n          this.scoreService.submit(name, value)\n          window.setTimeout(() => this.reset(), 3000)\n          this.toggleModals()\n        })\n        window.addEventListener('keydown', (event) => {\n          if (event.key === 'Escape') {\n            this.toggleModals()\n          }\n        })\n        document.getElementById('close-modal-button').addEventListener('click', () => {\n          this.toggleModals()\n        })\n      }\n      this.toggleModals()\n    }\n  }\n\n  toggleModals () {\n    document.getElementById('modal-overlay').classList.toggle('closed')\n    document.getElementById('leaderboard-modal').classList.toggle('closed')\n  }\n}\n"],"names":["SQUARE_SIDE_LENGTH","Grid","constructor","canvas","context","speed","this","shapes","movingShape","undefined","moveShapeDown","thereIsRoomToMoveDown","moveDown","moveShapeLeft","thereIsRoomToMoveLeft","moveLeft","moveShapeRight","thereIsRoomToMoveRight","moveRight","moveShapeToBottom","noOtherShapeIsInTheWayDown","points","squares","map","square","point","shape","otherPoints","filter","some","otherPoint","diff","Math","round","y","diffSmallEnough","abs","calculatedValue","x","length","noOtherShapeIsInTheWayLeft","noOtherShapeIsInTheWayRight","rotateShape","originalCoordinates","getCoordinatesOfSquares","rotateClockwise","allPointsFitInsideGrid","noOtherShapeIsInTheWay","restoreCoordinatesOfSquares","every","width","height","getLargestY","getSmallestX","getLargestX","removeFullRows","amountOfPointsInRow","rowCount","fullRowCount","i","occupiedSquaresAndShapes","Map","set","size","remove","shiftDownward","rowIndex","yLimit","moveSquaresBelowYLimit","otherShape","hasCommonPointWith","hasOccupiedPoint","includes","print","allRows","row","Score","high","getHighScore","document","getElementById","innerText","current","highScore","localStorage","getItem","calculateIncrease","rowsCleared","increment","value","get","newValue","submit","setItem","classList","add","setTimeout","Game","shapeGenerator","leaderboard","update","grid","roundYCoordinatesToNearestTen","requestScoreIncrease","requestSpeedIncrease","generatedShape","generateShape","push","end","draw","clearRect","forEach","drawAsRectangles","drawAsSquares","gameLoop","isPaused","isOver","currentAnimationFrameRequestId","window","requestAnimationFrame","init","setCanvasWidth","setCanvasHeight","hidden","style","display","score","shownValue","SCORE_PER_SPEED_INCREASE","MAX_SPEED","paused","event","key","pause","keyPressed","keyHandler","bind","addEventListener","pauseKeyHandler","reset","screen","availWidth","desiredHeight","availHeight","showGameOverText","clearInterval","heartbeatInterval","removeEventListener","showScoreSubmissionModalIfEligible","desiredShownValue","trunc","increaseIfNecessary","cancelAnimationFrame","Point","moveDownBy","distance","transformClockwise","oldX","oldY","translate","offsetX","offsetY","roundXCoordinateToNearestTen","roundYCoordinateToNearestTen","equals","occupiesCoordinates","roundToNearestTen","number","toFixed","Square","fillStyle","sideLength","beginPath","fillRect","clear","otherSquare","overlaps","isBelowLimit","Shape","pointOfTranslation","pointOfTranslationSquare","otherSquares","largestY","calculateLargestY","smallestX","calculateSmallestX","largestX","calculateLargestX","getPointOfTranslationX","squareToRemove","Object","prototype","hasOwnProperty","call","drawPoints","drawPoint","hasPoint","thisPoint","sort","a","b","shift","pop","verticalRectangles","squareA","squareB","reduce","acc","earlierContiguousSquare","find","earlierSquare","drawingHeight","drawingWidth","rect","shapeTypes","I","xCoordOfAppearance","super","O","point1","point2","point3","L","J","S","Z","T","createElement","setAttribute","append","getContext","pixelsPerFrame","increase","parseFloat","shapeTypesAsArray","values","ChosenShapeType","random","leaderboardService","boardUrl","scoresUrl","eligibilityUrl","name","fetch","method","headers","body","JSON","stringify","response","ok","console","log","status","statusText","scores","json","error","isEligible","params","URLSearchParams","errorMessage","scoreService","replaceChildren","leftDiv","rightDiv","contains","toggleModals","toggle"],"sourceRoot":""}
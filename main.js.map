{"version":3,"sources":["webpack://squarefall/./src/constants.js","webpack://squarefall/./src/grid/grid.js","webpack://squarefall/./src/score/score.js","webpack://squarefall/./src/game/game.js","webpack://squarefall/./src/point/point.js","webpack://squarefall/./src/square/square.js","webpack://squarefall/./src/shape/shape.js","webpack://squarefall/./src/bootstrap.js","webpack://squarefall/./src/speed/speed.js","webpack://squarefall/./src/shape-generator/shape-generator.js"],"names":["SQUARE_SIDE_LENGTH","Grid","canvas","context","speed","this","shapes","movingShape","undefined","thereIsRoomToMoveDown","moveDown","thereIsRoomToMoveLeft","moveLeft","thereIsRoomToMoveRight","moveRight","moveShapeDown","clear","roundYCoordinatesToNearestTen","draw","points","squares","map","square","point","shape","otherPoints","filter","some","otherPoint","diff","Math","round","y","diffSmallEnough","abs","calculatedValue","x","length","rotateClockwise","allPointsFitInsideGrid","noOtherShapeIsInTheWay","rotateCounterClockwise","every","width","height","getLargestY","noOtherShapeIsInTheWayDown","getSmallestX","noOtherShapeIsInTheWayLeft","getLargestX","noOtherShapeIsInTheWayRight","amountOfPointsInRow","rowCount","fullRowCount","i","occupiedSquaresAndShapes","Map","set","size","remove","shiftDownward","rowIndex","yLimit","clearAndMoveSquaresBelowYLimit","otherShape","hasCommonPointWith","strokeStyle","beginPath","moveTo","lineTo","stroke","drawPoints","drawCoordinates","hasOccupiedPoint","includes","allRows","row","Score","high","getHighScore","document","getElementById","innerText","current","highScore","localStorage","getItem","rowsCleared","value","newValue","setItem","classList","add","setTimeout","Game","shapeGenerator","grid","generatedShape","generateShape","push","end","isPaused","isOver","update","redrawMovingShape","currentAnimationFrameRequestId","window","requestAnimationFrame","gameLoop","setCanvasWidth","setCanvasHeight","hidden","style","display","score","shownValue","SCORE_PER_SPEED_INCREASE","MAX_SPEED","paused","event","key","pause","keyPressed","moveShapeLeft","rotateShape","moveShapeRight","moveShapeToBottom","removeFullRows","requestScoreIncrease","requestSpeedIncrease","drawAllPoints","drawEdgePoints","drawLines","keyHandler","bind","addEventListener","pauseKeyHandler","screen","availWidth","desiredHeight","availHeight","submit","showGameOverText","clearInterval","heartbeatInterval","removeEventListener","desiredSpeed","trunc","get","increaseIfNecessary","increment","cancelAnimationFrame","Point","distance","oldX","oldY","translate","offsetX","offsetY","yWhole10","toFixed","Square","fillStyle","sideLength","fillRect","arc","PI","fillText","drawEdgePoint","color","clearRect","otherSquare","equals","moveDownBy","transformClockwise","transformCounterClockwise","occupiesCoordinates","roundYCoordinateToNearestTen","Shape","pointOfTranslation","pointOfTranslationSquare","otherSquares","largestY","calculateLargestY","smallestX","calculateSmallestX","largestX","calculateLargestX","getPointOfTranslationX","squareToRemove","Object","prototype","hasOwnProperty","call","forEach","drawPoint","thisPoint","overlaps","sort","a","b","shift","pop","redraw","isBelowLimit","clearAndMoveDownBy","I","xCoordOfAppearance","super","init","O","point1","point2","point3","L","J","S","Z","T","createElement","setAttribute","append","getContext","squareSideLength","divisor","calculateValue","increase","shapeTypesAsArray","values","ChosenShapeType","random"],"mappings":"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","file":"main.js","sourcesContent":["export const SQUARE_SIDE_LENGTH = 50\n","import {\n  SQUARE_SIDE_LENGTH\n} from '../constants.js'\n\nexport const emptySquareCharacter = '\\u2b1c'\nexport const fullSquareCharacter = '\\u2b1b'\n\nexport default class Grid {\n  constructor (canvas, context, speed) {\n    this.canvas = canvas\n    this.context = context\n    this.speed = speed\n    this.shapes = []\n    this.movingShape = undefined\n  }\n\n  moveShapeDown () {\n    if (this.thereIsRoomToMoveDown()) {\n      this.movingShape.moveDown()\n    }\n  }\n\n  moveShapeLeft () {\n    if (this.thereIsRoomToMoveLeft()) {\n      this.movingShape.moveLeft()\n    }\n  }\n\n  moveShapeRight () {\n    if (this.thereIsRoomToMoveRight()) {\n      this.movingShape.moveRight()\n    }\n  }\n\n  moveShapeToBottom () {\n    while (this.thereIsRoomToMoveDown()) {\n      this.moveShapeDown()\n    }\n    this.movingShape.clear()\n    this.movingShape.roundYCoordinatesToNearestTen()\n    this.movingShape.draw()\n  }\n\n  noOtherShapeIsInTheWayDown () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint => {\n              const diff = Math.round(otherPoint.y - (point.y + SQUARE_SIDE_LENGTH))\n              const diffSmallEnough = Math.abs(diff) <= this.speed.calculatedValue\n              const meets = otherPoint.x === point.x && diffSmallEnough && diff >= 0\n              return meets\n            })\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  noOtherShapeIsInTheWayLeft () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x + SQUARE_SIDE_LENGTH === point.x &&\n              Math.abs(point.y - otherPoint.y) < SQUARE_SIDE_LENGTH)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  noOtherShapeIsInTheWayRight () {\n    const points = this.movingShape.squares.map(square => square.point)\n\n    for (const shape of this.shapes) {\n      if (shape !== this.movingShape) {\n        const otherPoints = shape.squares.map(square => square.point)\n\n        const commonPoints = points\n          .filter(point => otherPoints\n            .some(otherPoint =>\n              otherPoint.x === point.x + SQUARE_SIDE_LENGTH &&\n              Math.abs(point.y - otherPoint.y) < SQUARE_SIDE_LENGTH)\n          )\n\n        if (commonPoints.length > 0) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  rotateShape () {\n    this.movingShape.clear()\n    this.movingShape.rotateClockwise()\n\n    if (!(this.allPointsFitInsideGrid() && this.noOtherShapeIsInTheWay(this.movingShape))) {\n      this.movingShape.rotateCounterClockwise()\n    }\n\n    this.movingShape.draw()\n  }\n\n  allPointsFitInsideGrid () {\n    return this.movingShape.squares.map(square => square.point.x)\n      .every(x => x >= 0 && x <= this.canvas.width - SQUARE_SIDE_LENGTH) &&\n      this.movingShape.squares.map(square => square.point.y)\n        .every(y => y >= 0 && y <= this.canvas.height - SQUARE_SIDE_LENGTH)\n  }\n\n  thereIsRoomToMoveDown () {\n    const largestY = this.movingShape.getLargestY()\n    return (largestY + SQUARE_SIDE_LENGTH < this.canvas.height) && this.noOtherShapeIsInTheWayDown()\n  }\n\n  thereIsRoomToMoveLeft () {\n    return this.movingShape.getSmallestX() - SQUARE_SIDE_LENGTH >= 0 && this.noOtherShapeIsInTheWayLeft()\n  }\n\n  thereIsRoomToMoveRight () {\n    return this.movingShape.getLargestX() + SQUARE_SIDE_LENGTH < this.canvas.width && this.noOtherShapeIsInTheWayRight()\n  }\n\n  removeFullRows () {\n    const amountOfPointsInRow = this.canvas.width / SQUARE_SIDE_LENGTH\n    const rowCount = this.canvas.height / SQUARE_SIDE_LENGTH\n    let fullRowCount = 0\n\n    for (let i = 0; i < rowCount; i += 1) {\n      const occupiedSquaresAndShapes = new Map()\n      for (const shape of this.shapes) {\n        for (const square of shape.squares) {\n          if (square.point.y === i * SQUARE_SIDE_LENGTH) {\n            occupiedSquaresAndShapes.set(square, shape)\n          }\n        }\n      }\n\n      if (occupiedSquaresAndShapes.size === amountOfPointsInRow) {\n        fullRowCount += 1\n        for (const [square, shape] of occupiedSquaresAndShapes) {\n          square.clear()\n          shape.remove(square)\n        }\n        this.shiftDownward(i)\n      }\n    }\n    return fullRowCount\n  }\n\n  shiftDownward (rowIndex) {\n    //  Everything that is above this rowIndex must shift down by SIDE_LENGTH.\n    const yLimit = rowIndex * SQUARE_SIDE_LENGTH\n    for (const shape of this.shapes) {\n      const redraw = shape.clearAndMoveSquaresBelowYLimit(yLimit)\n      if (redraw) {\n        shape.draw()\n      }\n    }\n  }\n\n  noOtherShapeIsInTheWay (shape) {\n    for (const otherShape of this.shapes) {\n      if (otherShape !== shape) {\n        if (otherShape.hasCommonPointWith(shape)) {\n          return false\n        }\n      }\n    }\n\n    return true\n  }\n\n  drawLines () {\n    const rowCount = this.canvas.height / SQUARE_SIDE_LENGTH\n    for (let i = 1; i < rowCount; i += 1) {\n      this.context.strokeStyle = 'black'\n      this.context.beginPath()\n      this.context.moveTo(0, i * SQUARE_SIDE_LENGTH)\n      this.context.lineTo(this.canvas.width, i * SQUARE_SIDE_LENGTH)\n      this.context.stroke()\n    }\n  }\n\n  drawAllPoints () {\n    for (const shape of this.shapes) {\n      shape.drawPoints()\n    }\n  }\n\n  drawCoordinates () {\n    for (const shape of this.shapes) {\n      shape.drawCoordinates()\n    }\n  }\n\n  hasOccupiedPoint (x, y) {\n    const hasOccupiedPointPerShape = this.shapes.map(shape => shape.hasOccupiedPoint(x, y))\n    return hasOccupiedPointPerShape.includes(true)\n  }\n\n  print () {\n    let allRows = ''\n    for (let y = 0; y < this.canvas.height; y += SQUARE_SIDE_LENGTH) {\n      let row = ''\n      for (let x = 0; x < this.canvas.width; x += SQUARE_SIDE_LENGTH) {\n        if (this.hasOccupiedPoint(x, y)) {\n          row += fullSquareCharacter\n        } else {\n          row += emptySquareCharacter\n        }\n      }\n      if (y !== this.canvas.height - SQUARE_SIDE_LENGTH) {\n        row += '\\n'\n      }\n      allRows += row\n    }\n    return allRows\n  }\n}\n","export default class Score {\n  constructor () {\n    this.high = Score.getHighScore()\n    document.getElementById('high-score').innerText = this.high\n    this.current = 0\n  }\n\n  static getHighScore () {\n    let highScore = localStorage.getItem('tetris-high')\n    if (highScore === undefined) {\n      highScore = 0\n    }\n    return highScore\n  }\n\n  static calculateIncrease (rowsCleared) {\n    const score = (2 ** rowsCleared) + 2\n    return score\n  }\n\n  increment (value) {\n    this.current += value\n    document.getElementById('current-score').innerText = this.current\n  }\n\n  get () {\n    return this.current\n  }\n\n  set (newValue) {\n    this.current = newValue\n  }\n\n  submit () {\n    if (this.current > this.high) {\n      localStorage.setItem('tetris-high', this.current)\n      document.getElementById('high-score').innerText = this.current\n      document.getElementById('scoreContainer').classList.add('shaken')\n      setTimeout(\n        () => document.getElementById('scoreContainer').classList.remove('shaken'),\n        1000\n      )\n    }\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nimport Grid from '../grid/grid.js'\nimport Score from '../score/score.js'\n\nexport class Game {\n  constructor (canvas, context, shapeGenerator, speed) {\n    this.canvas = canvas\n    this.context = context\n    this.shapeGenerator = shapeGenerator\n    this.speed = speed\n  }\n\n  update () {\n    if (this.grid.movingShape) {\n      if (!this.grid.thereIsRoomToMoveDown()) {\n        this.grid.movingShape.clear()\n        this.grid.movingShape.roundYCoordinatesToNearestTen()\n        this.grid.movingShape.draw()\n        this.grid.movingShape = undefined\n      }\n    } else {\n      const generatedShape = this.shapeGenerator.generateShape()\n      if (this.grid.noOtherShapeIsInTheWay(generatedShape)) {\n        this.grid.shapes.push(generatedShape)\n        this.grid.movingShape = generatedShape\n      } else {\n        this.end()\n      }\n    }\n\n    if (this.grid.movingShape && this.grid.thereIsRoomToMoveDown()) {\n      this.grid.moveShapeDown()\n    }\n  }\n\n  redrawMovingShape () {\n    if (this.grid.movingShape) {\n      this.grid.movingShape.clear()\n      this.grid.movingShape.draw()\n    }\n  }\n\n  gameLoop () {\n    if (!this.isPaused && !this.isOver) {\n      this.update()\n      this.redrawMovingShape()\n      this.currentAnimationFrameRequestId = window.requestAnimationFrame(() => this.gameLoop())\n    }\n  }\n\n  init () {\n    this.setCanvasWidth()\n    this.setCanvasHeight()\n\n    window.setTimeout(() => {\n      document.getElementById('loading').hidden = true\n      document.getElementById('container').style.display = 'grid'\n    }, 200) // to allow the user some time to spot the loading text\n\n    this.grid = new Grid(this.canvas, this.context, this.speed)\n    const generatedShape = this.shapeGenerator.generateShape()\n    this.grid.shapes.push(generatedShape)\n    this.grid.movingShape = generatedShape\n    generatedShape.draw()\n    this.score = new Score()\n    document.getElementById('current-speed').innerText = this.speed.shownValue\n    this.SCORE_PER_SPEED_INCREASE = 50\n    this.MAX_SPEED = 9\n    this.paused = (event) => {\n      if (this.grid.movingShape) {\n        switch (event.key) {\n          case 'p': this.pause(); break\n          default: break\n        }\n      }\n    }\n    this.keyPressed = (event) => {\n      if (this.grid.movingShape) {\n        switch (event.key) {\n          case 'j':\n            this.grid.moveShapeLeft()\n            break\n          case 'k':\n            this.grid.rotateShape()\n            break\n          case 'l':\n            this.grid.moveShapeRight()\n            break\n          case ' ':\n            this.grid.moveShapeToBottom()\n            if (!this.grid.thereIsRoomToMoveDown()) {\n              this.grid.movingShape = undefined\n              const fullRowCount = this.grid.removeFullRows()\n              if (fullRowCount > 0) {\n                this.requestScoreIncrease(fullRowCount)\n                this.requestSpeedIncrease()\n              }\n            }\n            break\n          case '1': this.grid.drawAllPoints(); break\n          case '2': this.grid.drawCoordinates(); break\n          case '3': this.grid.movingShape.drawEdgePoints(); break\n          case '4': this.grid.drawLines(); break\n          default: break\n        }\n      }\n    }\n    this.keyHandler = this.keyPressed.bind(this)\n    window.addEventListener('keypress', this.keyHandler)\n    this.pauseKeyHandler = this.paused.bind(this)\n    window.addEventListener('keypress', this.pauseKeyHandler)\n\n    this.isPaused = false\n\n    this.currentAnimationFrameRequestId = window.requestAnimationFrame(() => this.gameLoop())\n  }\n\n  setCanvasWidth () {\n    const desiredWidth = 10 * SQUARE_SIDE_LENGTH\n\n    if (desiredWidth < window.screen.availWidth) {\n      this.canvas.width = desiredWidth\n    }\n  }\n\n  setCanvasHeight () {\n    let desiredHeight = window.screen.availHeight\n\n    if (desiredHeight % 100 !== 0) {\n      desiredHeight -= desiredHeight % 100\n    }\n\n    desiredHeight -= 100 // To leave room for browser/OS UI toolbars\n\n    if (desiredHeight > 20 * SQUARE_SIDE_LENGTH) {\n      desiredHeight = 20 * SQUARE_SIDE_LENGTH\n    }\n\n    this.canvas.height = desiredHeight\n  }\n\n  end () {\n    this.score.submit()\n    Game.showGameOverText()\n    window.clearInterval(this.heartbeatInterval)\n    window.removeEventListener('keypress', this.keyHandler)\n    window.removeEventListener('keypress', this.pauseKeyHandler)\n    this.isOver = true\n  }\n\n  requestSpeedIncrease () {\n    if (this.speed.shownValue < this.MAX_SPEED) {\n      const desiredSpeed = Math.trunc(this.score.get() / this.SCORE_PER_SPEED_INCREASE)\n      this.speed.increaseIfNecessary(desiredSpeed)\n    }\n  }\n\n  requestScoreIncrease (rowsCleared) {\n    this.score.increment(rowsCleared)\n  }\n\n  pause () {\n    if (this.isPaused) {\n      this.isPaused = false\n      window.addEventListener('keypress', this.keyHandler)\n      this.gameLoop()\n    } else {\n      this.isPaused = true\n      window.cancelAnimationFrame(this.currentAnimationFrameRequestId)\n      window.removeEventListener('keypress', this.keyHandler)\n    }\n  }\n\n  static showGameOverText () {\n    document.getElementById('gameOverContainer').hidden = false\n  }\n}\n","import {\n  SQUARE_SIDE_LENGTH\n} from '../constants.js'\n\nexport default class Point {\n  constructor (x, y) {\n    this.x = x\n    this.y = y\n  }\n\n  moveDownBy (distance) {\n    this.y += distance\n  }\n\n  moveLeft () {\n    this.x += -SQUARE_SIDE_LENGTH\n  }\n\n  moveRight () {\n    this.x += SQUARE_SIDE_LENGTH\n  }\n\n  transformClockwise (oldX, oldY) {\n    this.translate(-oldX, -oldY)\n    this.rotateClockwise()\n    this.translate(oldX, oldY)\n  }\n\n  transformCounterClockwise (oldX, oldY) {\n    this.translate(-oldX, -oldY)\n    this.rotateCounterClockwise()\n    this.translate(oldX, oldY)\n  }\n\n  translate (offsetX, offsetY) {\n    this.x = this.x + offsetX\n    this.y = this.y + offsetY\n  }\n\n  rotateClockwise () {\n    const oldX = this.x\n    const oldY = this.y\n\n    /*\n    We are performing a clockwise 90 degree rotation in a 2D coordinate system.\n    https://en.wikipedia.org/wiki/Rotation_matrix\n\n    90 degrees = Math.PI / 2 radians\n    Math.sin(Math.PI / 2) = 1\n    Math.cos(Math.PI / 2) = 0\n\n    newX = oldX * 0 - oldY * 1 = -oldY\n    newY = oldX * 1 + oldY * 0 = oldX\n    */\n\n    this.x = -oldY\n    this.y = oldX\n  }\n\n  rotateCounterClockwise () {\n    const oldX = this.x\n    const oldY = this.y\n\n    /*\n    We are performing a counter-clockwise 90 degree rotation in a 2D coordinate system.\n    https://en.wikipedia.org/wiki/Rotation_matrix\n\n    -90 degrees = 3 * Math.PI / 2 radians\n    Math.sin(3 * Math.PI / 2) = -1\n    Math.cos(3 * Math.PI / 2) = 0\n\n    newX = oldX * 0 - oldY * -1 = oldY\n    newY = oldX * -1 + oldY * 0 = -oldX\n    */\n\n    this.x = oldY\n    this.y = -oldX\n  }\n\n  equals (otherPoint) {\n    return otherPoint instanceof Point &&\n      typeof otherPoint.x === 'number' &&\n      typeof otherPoint.y === 'number' &&\n      this.x === otherPoint.x &&\n      this.y === otherPoint.y\n  }\n\n  occupiesCoordinates (x, y) {\n    return this.x === x && this.y === y\n  }\n\n  roundYCoordinateToNearestTen () {\n    const y = this.y // e.g. 851\n    const yDiv = y / 10 // e.g. 85.1\n    const yWhole = yDiv.toFixed() // e.g. 85\n    const yWhole10 = yWhole * 10 // e.g. 850\n    this.y = yWhole10\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nexport default class Square {\n  constructor (point, fillStyle, context, speed) {\n    // The point of a Square always refers to its top left point\n    this.point = point\n    this.fillStyle = fillStyle\n    this.context = context\n    this.sideLength = SQUARE_SIDE_LENGTH\n    this.speed = speed\n  }\n\n  draw () {\n    this.context.beginPath()\n    this.context.fillStyle = this.fillStyle\n    this.context.fillRect(this.point.x, this.point.y, this.sideLength, this.sideLength)\n  }\n\n  drawPoint () {\n    this.context.beginPath()\n    this.context.strokeStyle = 'red'\n    this.context.arc(this.point.x, this.point.y, 10, 0, 2 * Math.PI)\n    this.context.stroke()\n  }\n\n  drawCoordinates () {\n    this.context.fillStyle = 'black'\n    this.context.fillText(`${this.point.x} | ${this.point.y}`, this.point.x, this.point.y)\n  }\n\n  drawEdgePoints () {\n    this.drawEdgePoint('yellow', this.point.x, this.point.y)\n    this.drawEdgePoint('blue', this.point.x + SQUARE_SIDE_LENGTH, this.point.y)\n    this.drawEdgePoint('magenta', this.point.x + SQUARE_SIDE_LENGTH, this.point.y + SQUARE_SIDE_LENGTH)\n    this.drawEdgePoint('black', this.point.x, this.point.y + SQUARE_SIDE_LENGTH)\n  }\n\n  drawEdgePoint (color, x, y) {\n    this.context.beginPath()\n    this.context.strokeStyle = color\n    this.context.arc(x, y, 10, 0, 2 * Math.PI)\n    this.context.stroke()\n  }\n\n  clear () {\n    this.context.clearRect(this.point.x, this.point.y, this.sideLength, this.sideLength)\n  }\n\n  equals (otherSquare) {\n    return otherSquare !== undefined &&\n      otherSquare instanceof Square &&\n      this.sideLength === otherSquare.sideLength &&\n      this.point.equals(otherSquare.point)\n  }\n\n  overlaps (otherSquare) {\n    return otherSquare !== undefined &&\n      otherSquare instanceof Square &&\n      this.sideLength === otherSquare.sideLength &&\n      Math.abs(this.point.x - otherSquare.point.x) < SQUARE_SIDE_LENGTH &&\n      Math.abs(this.point.y - otherSquare.point.y) < SQUARE_SIDE_LENGTH\n  }\n\n  moveDownBy (distance) {\n    this.clear()\n    this.point.moveDownBy(distance)\n    this.draw()\n  }\n\n  clearAndMoveDownBy (distance) {\n    this.clear()\n    this.point.moveDownBy(distance)\n  }\n\n  moveLeft () {\n    this.clear()\n    this.point.moveLeft()\n    this.draw()\n  }\n\n  moveRight () {\n    this.clear()\n    this.point.moveRight()\n    this.draw()\n  }\n\n  transformClockwise (x, y) {\n    this.point.transformClockwise(x, y)\n  }\n\n  transformCounterClockwise (x, y) {\n    this.point.transformCounterClockwise(x, y)\n  }\n\n  isBelowLimit (yLimit) {\n    return this.point.y < yLimit\n  }\n\n  hasOccupiedPoint (x, y) {\n    return this.point.occupiesCoordinates(x, y)\n  }\n\n  roundYCoordinateToNearestTen () {\n    this.point.roundYCoordinateToNearestTen()\n  }\n}\n","import { SQUARE_SIDE_LENGTH } from '../constants.js'\n\nimport Point from '../point/point.js'\nimport Square from '../square/square.js'\n\nexport class Shape {\n  init (fillStyle, pointOfTranslation, points, context, speed) {\n    this.pointOfTranslation = pointOfTranslation\n\n    const pointOfTranslationSquare = new Square(pointOfTranslation, fillStyle, context, speed)\n    const otherSquares = points.map(point => new Square(point, fillStyle, context, speed))\n\n    this.squares = [pointOfTranslationSquare, ...otherSquares]\n\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n\n    this.context = context\n    this.speed = speed\n  }\n\n  getPointOfTranslationX () {\n    return this.getPointOfTranslationX\n  }\n\n  remove (squareToRemove) {\n    if (Object.prototype.hasOwnProperty.call(squareToRemove, 'point') &&\n      Object.prototype.hasOwnProperty.call(squareToRemove.point, 'x') &&\n      Object.prototype.hasOwnProperty.call(squareToRemove.point, 'y')) {\n      this.squares = this.squares.filter(square => !(square.equals(squareToRemove)))\n      this.largestY = this.calculateLargestY()\n      this.smallestX = this.calculateSmallestX()\n      this.largestX = this.calculateLargestX()\n    }\n  }\n\n  draw () {\n    this.squares.forEach(square => square.draw())\n  }\n\n  drawPoints () {\n    this.squares.forEach(square => square.drawPoint())\n  }\n\n  drawCoordinates () {\n    this.squares.forEach((square) => square.drawCoordinates())\n  }\n\n  markPointOfTranslation () {\n    this.context.fillStyle = 'rgba(120, 230, 244, 0.2)'\n\n    this.context.beginPath()\n    this.context.arc(this.pointOfTranslation.x, this.pointOfTranslation.y, 10, 0, 2 * Math.PI)\n    this.context.stroke()\n  }\n\n  drawEdgePoints () {\n    this.squares.forEach(square => {\n      square.drawEdgePoints()\n    })\n  }\n\n  clear () {\n    this.squares.forEach(square => square.clear())\n  }\n\n  rotateClockwise () {\n    this.squares.forEach(square => {\n      square.transformClockwise(this.pointOfTranslation.x, this.pointOfTranslation.y)\n    })\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  rotateCounterClockwise () {\n    this.squares.forEach(square => {\n      square.transformCounterClockwise(this.pointOfTranslation.x, this.pointOfTranslation.y)\n    })\n    this.largestY = this.calculateLargestY()\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  hasPoint (otherPoint) {\n    const points = this.squares.map(square => new Point(square.point.x, square.point.y))\n    const thisPoint = points.filter(point => point.equals(otherPoint))\n    return thisPoint !== undefined && thisPoint.length && thisPoint.length !== 0 && thisPoint.equals(otherPoint)\n  }\n\n  hasCommonPointWith (otherShape) {\n    for (const square of this.squares) {\n      for (const otherSquare of otherShape.squares) {\n        if (square.overlaps(otherSquare)) {\n          return true\n        }\n      }\n    }\n\n    return false\n  }\n\n  moveDown () {\n    this.clear()\n    this.squares.forEach(square => square.moveDownBy(this.speed.calculatedValue))\n    this.largestY = this.calculateLargestY()\n    this.draw()\n  }\n\n  moveLeft () {\n    this.squares.forEach(square => square.moveLeft())\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  moveRight () {\n    this.squares.forEach(square => square.moveRight())\n    this.smallestX = this.calculateSmallestX()\n    this.largestX = this.calculateLargestX()\n  }\n\n  calculateLargestY () {\n    return this.squares\n      .map(square => square.point.y)\n      .sort((a, b) => b - a)[0]\n  }\n\n  calculateSmallestX () {\n    return this.squares\n      .map(square => square.point.x)\n      .sort()\n      .shift()\n  }\n\n  calculateLargestX () {\n    return this.squares\n      .map(square => square.point.x)\n      .sort()\n      .pop()\n  }\n\n  getLargestY () {\n    return this.largestY\n  }\n\n  getSmallestX () {\n    return this.smallestX\n  }\n\n  getLargestX () {\n    return this.largestX\n  }\n\n  clearAndMoveSquaresBelowYLimit (yLimit) {\n    let redraw = false\n    this.squares.forEach(square => {\n      if (square.isBelowLimit(yLimit)) {\n        square.clearAndMoveDownBy(SQUARE_SIDE_LENGTH)\n        redraw = true\n      }\n    })\n    return redraw\n  }\n\n  hasOccupiedPoint (x, y) {\n    const hasOccupiedPointPerSquare = this.squares.map(square => square.hasOccupiedPoint(x, y))\n    return hasOccupiedPointPerSquare.includes(true)\n  }\n\n  roundYCoordinatesToNearestTen () {\n    this.squares.forEach(square => {\n      square.roundYCoordinateToNearestTen()\n    })\n  }\n}\n\nclass O extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const point3 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'thistle'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  rotateClockwise () { }\n\n  // eslint-disable-next-line class-methods-use-this\n  rotateCounterClockwise () { }\n}\n\nclass T extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH, speed)\n    const point2 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const point3 = new Point(xCoordOfAppearance, 0, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'lightgrey'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass I extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const pointOfTranslation = new Point(xCoordOfAppearance, 0, speed)\n    const point1 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, 0, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'yellowgreen'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass S extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const point3 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'khaki'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass Z extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, SQUARE_SIDE_LENGTH, speed)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'tan'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass L extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, 0, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const point2 = new Point(xCoordOfAppearance, 0, speed)\n    const point3 = new Point(xCoordOfAppearance - 2 * SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'lightblue'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nclass J extends Shape {\n  constructor (xCoordOfAppearance, context, speed) {\n    super()\n\n    const point1 = new Point(xCoordOfAppearance - SQUARE_SIDE_LENGTH, 0, speed)\n    const pointOfTranslation = new Point(xCoordOfAppearance, 0, speed)\n    const point2 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, 0, speed)\n    const point3 = new Point(xCoordOfAppearance + SQUARE_SIDE_LENGTH, SQUARE_SIDE_LENGTH, speed)\n\n    const otherPoints = [point1, point2, point3]\n\n    const fillStyle = 'darksalmon'\n\n    super.init(fillStyle, pointOfTranslation, otherPoints, context, speed)\n  }\n}\n\nconst shapeTypes = {\n  I,\n  O,\n  L,\n  J,\n  S,\n  Z,\n  T\n}\n\nexport default shapeTypes\n","import { SQUARE_SIDE_LENGTH } from './constants.js'\n\nimport { Game } from './game/game.js'\nimport { ShapeGenerator } from './shape-generator/shape-generator.js'\nimport Speed from './speed/speed.js'\n\nconst canvas = document.createElement('canvas')\ncanvas.setAttribute('id', 'gameCanvas')\n\nconst gameContainer = document.getElementById('gameContainer')\ngameContainer.append(canvas)\n\nconst context = canvas.getContext('2d')\nconst speed = new Speed(SQUARE_SIDE_LENGTH)\nconst shapeGenerator = new ShapeGenerator(canvas, context, speed)\nconst game = new Game(canvas, context, shapeGenerator, speed)\n\ngame.init()\n","export default class Speed {\n  constructor (squareSideLength) {\n    this.squareSideLength = squareSideLength\n    this.shownValue = 0\n    this.divisor = 30\n    this.calculatedValue = this.calculateValue(squareSideLength, this.divisor)\n  }\n\n  increase () {\n    this.shownValue += 1\n    this.divisor -= 1\n    this.calculatedValue = this.calculateValue(this.squareSideLength, this.divisor)\n  }\n\n  increaseIfNecessary (desiredSpeed) {\n    if (desiredSpeed > this.shownValue) {\n      this.increase()\n      document.getElementById('speedContainer').classList.add('shaken')\n      setTimeout(\n        () => document.getElementById('speedContainer').classList.remove('shaken'),\n        1000\n      )\n      document.getElementById('current-speed').innerText = this.shownValue\n    }\n    return this.shownValue\n  }\n\n  calculateValue (squareSideLength, divisor) {\n    return Math.round(squareSideLength / divisor)\n  }\n}\n","import shapeTypes from '../shape/shape.js'\n\nexport class ShapeGenerator {\n  constructor (canvas, context, speed) {\n    this.canvas = canvas\n    this.context = context\n    this.speed = speed\n  }\n\n  generateShape () {\n    const shapeTypesAsArray = Object.values(shapeTypes)\n    const chosenShapeIndex = Math.round(Math.random() * (shapeTypesAsArray.length - 1))\n    const ChosenShapeType = shapeTypesAsArray[chosenShapeIndex]\n    const xCoordinateOfAppearance = this.canvas.width / 2\n    const shape = new ChosenShapeType(xCoordinateOfAppearance, this.context, this.speed)\n    return shape\n  }\n}\n"],"sourceRoot":""}